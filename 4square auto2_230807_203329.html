<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
.dot  {
   height: 50px;
   width:  50px;
   background-color: #fff;
   border-radius: 50%;
   display: inline-block;
}
.dot_red  {
   height: 50px;
   width:  50px;
   background-color: #f00;
   border-radius: 50%;
   display: inline-block;
}
.dot_blue  {
   height: 50px;
   width:  50px;
   background-color: #00f;
   border-radius: 50%;
   display: inline-block;
}
.dot_highlight {
   height: 40px;
   width: 40px;
   border: 5px solid yellow;
}
</style>
</head>

<body>
<br>
<br>
<br>
<br>
<br>

<table align = "center", border=0>
<tr>
      <td>
          <span id="dropper0"
            onclick='drop(0)'
            class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper1"
             onclick='drop(1)'
             class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper2"
             onclick='drop(2)'
            class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper3"
             onclick='drop(3)'
             class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper4"
             onclick='drop(4)'
            class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper5"
             onclick='drop(5)'
             class="dot_blue"></span>
      </td>
      <td>
           <span id="dropper6"
             onclick='drop(6)'
             class="dot_blue"></span>
      </td>
</tr>
<tr>
      <td>
          <input type="button" id="but0"
              onclick='drop(0)'
              style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but1"
              onclick='drop(1)'
              style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but2"
              onclick='drop(2)'
              style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but3"
              onclick='drop(3)'
              style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but4"
              onclick='drop(4)'
              style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but5"
              onclick='drop(5)'
             style="width:50px;height:15px;">
      </td>
      <td>
         <input type="button" id="but6"
              onclick='drop(6)'
             style="width:50px;height:15px;">
      </td>
</tr>
<tr>
      <td bgcolor=#5f856b>
           <span id="dot35" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot36" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot37" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot38" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot39" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot40" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot41" class="dot">
           </span>
      </td>
</tr>

<tr>
      <td bgcolor=#5f856b>
           <span id="dot28" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot29" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot30" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot31" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot32" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot33" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot34" class="dot">
           </span>
      </td>
</tr>

<tr>
      <td bgcolor=#5f856b>
           <span id="dot21" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot22" class="dot">
           </span>

      </td>
      <td bgcolor=#5f856b>
           <span id="dot23" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot24" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot25" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot26" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot27" class="dot">
           </span>
      </td>
</tr>

<tr>
      <td bgcolor=#5f856b>
           <span id="dot14" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot15" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot16" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot17" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot18" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot19" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot20" class="dot">
           </span>
      </td>
</tr>

<tr>
      <td bgcolor=#5f856b>
           <span id="dot7" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot8" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot9" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot10" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot11" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot12" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot13" class="dot">
           </span>
      </td>
</tr>

<tr>
      <td bgcolor=#5f856b>
           <span id="dot0" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span  id="dot1" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot2" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot3" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot4" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot5" class="dot">
           </span>
      </td>
      <td bgcolor=#5f856b>
           <span id="dot6" class="dot">
           </span>
      </td>
</tr>
</table>
<br>
<br>
<br>
<table align=center>
<tr>
    <td>
          Play mode:
    </td>
    <td>
      <select id="mode" onchange="freeze()">
              <option value=0> Human </option>
              <option value=1> Computer play blue </option>
              <option value=2> Computer play red </option>
        </select
     </td>
</tr>
</table>
<input type="hidden" id="player" value=1>
<input type="hidden" id="game_over" value=0>
<input type="hidden" id="circle0" value="0">
<input type="hidden" id="circle1" value="0">
<input type="hidden" id="circle2" value="0">
<input type="hidden" id="circle3" value="0">
<input type="hidden" id="circle4" value="0">
<input type="hidden" id="circle5" value="0">
<input type="hidden" id="circle6" value="0">
<input type="hidden" id="circle7" value="0">
<input type="hidden" id="circle8" value="0">
<input type="hidden" id="circle9" value="0">
<input type="hidden" id="circle10" value="0">
<input type="hidden" id="circle11" value="0">
<input type="hidden" id="circle12" value="0">
<input type="hidden" id="circle13" value="0">
<input type="hidden" id="circle14" value="0">
<input type="hidden" id="circle15" value="0">
<input type="hidden" id="circle16" value="0">
<input type="hidden" id="circle17" value="0">
<input type="hidden" id="circle18" value="0">
<input type="hidden" id="circle19" value="0">
<input type="hidden" id="circle20" value="0">
<input type="hidden" id="circle21" value="0">
<input type="hidden" id="circle22" value="0">
<input type="hidden" id="circle23" value="0">
<input type="hidden" id="circle24" value="0">
<input type="hidden" id="circle25" value="0">
<input type="hidden" id="circle26" value="0">
<input type="hidden" id="circle27" value="0">
<input type="hidden" id="circle28" value="0">
<input type="hidden" id="circle29" value="0">
<input type="hidden" id="circle30" value="0">
<input type="hidden" id="circle31" value="0">
<input type="hidden" id="circle32" value="0">
<input type="hidden" id="circle33" value="0">
<input type="hidden" id="circle34" value="0">
<input type="hidden" id="circle35" value="0">
<input type="hidden" id="circle36" value="0">
<input type="hidden" id="circle37" value="0">
<input type="hidden" id="circle38" value="0">
<input type="hidden" id="circle39" value="0">
<input type="hidden" id="circle40" value="0">
<input type="hidden" id="circle41" value="0">
</body>

<script>

var red_seq = [];
var blue_seq = [];
win_h_seq=/(,0,1,2,3,|,1,2,3,4,|,2,3,4,5,|,3,4,5,6,|,7,8,9,10,|,8,9,10,11,|,9,10,11,12,|,10,11,12,13,|,14,15,16,17,|,15,16,17,18,|,16,17,18,19,|,17,18,19,20,|,21,22,23,24,|,22,23,24,25,|,23,24,25,26,|,24,25,26,27,|,28,29,30,31,|,29,30,31,32,|,30,31,32,33,|,31,32,33,34,|,35,36,37,38,|,36,37,38,39,|,37,38,39,40,|,38,39,40,41,)/ ;
win_v_seq=/(,0,7,14,21,|,1,8,15,22,|,2,9,16,23,|,3,10,17,24,|,4,11,18,25,|,5,12,19,26,|,6,13,20,27,|,7,14,21,28,|,8,15,22,29,|,9,16,23,30,|,10,17,24,31,|,11,18,25,32,|,12,19,26,33,|,13,20,27,34,|,14,21,28,35,|,15,22,29,36,|,16,23,30,37,|,17,24,31,38,|,18,25,32,39,|,19,26,33,40,|,20,27,34,41,)/ ;
win_c_seq=/(,0,8,16,24,|,1,9,17,25,|,2,10,18,26,|,3,11,19,27,|,7,15,23,31,|,8,16,24,32,|,9,17,25,33,|,10,18,26,34,|,14,22,30,38,|,15,23,31,39,|,16,24,32,40,|,17,25,33,41,)/ ;
win_c2_seq=/(,3,9,15,21,|,4,10,16,22,|,5,11,17,23,|,6,12,18,24,|,10,16,22,28,|,11,17,23,29,|,12,18,24,30,|,13,19,25,31,|,17,23,29,35,|,18,24,30,36,|,19,25,31,37,|,20,26,32,38,)/ ;
win3_c_seq=/(,0,8,16,|,1,9,17,|,2,10,18,|,3,11,19,|,7,15,23,|,8,16,24,|,9,17,25,|,10,18,26,|,14,22,30,|,15,23,31,|,16,24,32,|,17,25,33,|,8,16,24,|,9,17,25,|,10,18,26,|,11,19,27,|,15,23,31,|,16,24,32,|,17,25,33,|,18,26,34,|,22,30,38,|,23,31,39,|,24,32,40,|,25,33,41,)/ ;
win3_c2_seq=/(,3,9,15,|,4,10,16,|,5,11,17,|,6,12,18,|,10,16,22,|,11,17,23,|,12,18,24,|,13,19,25,|,17,23,29,|,18,24,30,|,19,25,31,|,20,26,32,|,9,15,21,|,10,16,22,|,11,17,23,|,12,18,24,|,16,22,28,|,17,23,29,|,18,24,30,|,19,25,31,|,23,29,35,|,24,30,36,|,25,31,37,|,26,32,38,)/ ;

cross2_map=[0,1,3,6,10,15,21,2,4,7,11,16,22,27,5,8,12,17,23,28,32,9,13,18,24,29,33,36,14,19,25,30,34,37,39,20,26,31,35,38,40,41];

cross_map=[21,15,10,6,3,1,0,27,22,16,11,7,4,2,32,28,23,17,12,8,5,36,33,29,24,18,13,9,39,37,34,30,25,19,14,41,40,38,35,31,26,20];

function freeze(){
drop_status=0;
document.getElementById("mode").disabled = true;
if(document.getElementById("mode").value ==1) {
    column = select_column();
    drop_status=play(column);
};
}

function select_column(){

arr_curr_drop=[-2,-2,-2,-2,-2,-2,-2];
arr_next_drop=[-2,-2,-2,-2,-2,-2,-2];
for(j=0;j<=6;j++)  {
   for(i=0;i<=5;i++) {
      id = 7*i+j;
      if(document.getElementById("circle" + id).value==0){
            break;
        };
    };
    if (i<=5) {
    arr_curr_drop[j] = id;
    };
    if (i<5) {
     arr_next_drop[j] = id+7;
     };
};

if(document.getElementById("player").value==1)  {
   /* Checking blue win */
   /* horizontal*/
   for(j=0;j<=6;j++) {
      work_array = blue_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return a-b});
       if(win_h_seq.test("," + work_array.toString() + ",")){
         alert("Blue is going to win in horizontal");
          return(j);
        };
    };
     /* vertical */
   for(j=0;j<=6;j++) {
      work_array = blue_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return ((a%7)*6+Math.floor(a/7)) - ((b%7)*6+Math.floor(b/7))});
       if(win_v_seq.test("," + work_array.toString() + ",")){
          alert("Blue is going to win in vertical");
          return(j);
        };
    };
    /*cross*/
   for(j=0;j<=6;j++) {
      work_array = blue_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return cross_map[a] - cross_map[b] });
       if(win_c_seq.test("," + work_array.toString() + ",")){
          alert("Blue is going to win in cross");
          return(j);
        };
    };
    /*cross2*/
   for(j=0;j<=6;j++) {
      work_array = blue_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return cross2_map[a] - cross2_map[b] });
       if(win_c2_seq.test("," + work_array.toString() + ",")){
          alert("Blue is going to win in cross2");
          return(j);
        };
    };


   /* Checking  red win to block it */
   /*horizontal*/
   for(j=0;j<=6;j++) {
      work_array = red_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return a-b});
       if(win_h_seq.test("," + work_array.toString() + ",")){
          alert("Blocking red horizontal");
          return(j);
        };
    };
   /*vertical*/
   for(j=0;j<=6;j++) {
      work_array = red_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return ((a%7)*6+Math.floor(a/7)) - ((b%7)*6+Math.floor(b/7))});
       if(win_v_seq.test("," + work_array.toString() + ",")){
          alert("Blocking red vertical");
          return(j);
        };
    };
   /*cross*/
   for(j=0;j<=6;j++) {
      work_array = red_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return cross_map[a] - cross_map[b] });
       if(win_c_seq.test("," + work_array.toString() + ",")){
          alert("Blocking red in cross");
          return(j);
        };
    };
    /*cross2*/
   for(j=0;j<=6;j++) {
      work_array = red_seq.map(function(a){return a});
      work_array.push(arr_curr_drop[j]);
      work_array.sort(function(a,b){return cross2_map[a] - cross2_map[b] });
       if(win_c2_seq.test("," + work_array.toString() + ",")){
         alert("Blocking red in cross2");
          return(j);
        };
    };


    /*horizontal double drop*/
    for(j=0;j<=6;j++) {
      for(j_2=0;j_2<=6;j_2++){
        if(j!=j_2){
          work_array = red_seq.map(function(a){return a});
          work_array.push(arr_curr_drop[j]);
          work_array.push(arr_curr_drop[j_2]);
          work_array.sort(function(a,b){return a-b});
          if(win_h_seq.test("," + work_array.toString() + ",")){
           alert("Blocking red in horizontal double");
            return(j_2);
          };
        }
        else{
          work_array = red_seq.map(function(a){return a});
          work_array.push(arr_curr_drop[j]);
          work_array.push(arr_next_drop[j_2]);
          work_array.sort(function(a,b){return a-b});
          if(win_h_seq.test("," + work_array.toString() + ",")){
           alert("Avoiding red in horizonta double");
            arr_curr_drop[j]=-1;
          };
          work_array.sort(function(a,b){return cross_map[a] - cross_map[b] });
          if(win_c_seq.test("," + work_array.toString() + ",")){
            alert("Avoiding red in cross double");
            arr_curr_drop[j]=-1;
          };
          work_array.sort(function(a,b){return cross2_map[a] - cross2_map[b] });
          if(win_c2_seq.test("," + work_array.toString() + ",")){
            alert("Avoiding red in cross2 double");
            arr_curr_drop[j]=-1;
          };

        };

      };/*for j_2*/
    };/*for j*/

    /*cross_three*/
    for(j=0;j<=6;j++) {
       work_array = red_seq.map(function(a){return a});
       work_array.push(arr_curr_drop[j]);
       work_array.sort(function(a,b){return cross_map[a] - cross_map[b] });
        if(win3_c_seq.test("," + work_array.toString() + ",")&& arr_curr_drop[j]>0){
           alert("Blocking red in cross_three");
           return(j);
         };
     };
     /*cross2_three*/
    for(j=0;j<=6;j++) {
       work_array = red_seq.map(function(a){return a});
       work_array.push(arr_curr_drop[j]);
       work_array.sort(function(a,b){return cross2_map[a] - cross2_map[b] });
       console.log(work_array)
        if(win3_c2_seq.test("," + work_array.toString() + ",") && arr_curr_drop[j]>0){
          alert("Blocking red in cross2_three");
           return(j);
         };
     };

    loop_count=0;
    do{
      j=Math.floor(Math.random()*7);
      loop_count++;
    }while(arr_curr_drop[j]<0 && loop_count<=50);
    if (loop_count<=50){
      return(j);
    };


};/* player Blue */
return(Math.floor(Math.random()*7));
}

function drop(column){
if (!(document.getElementById("but" +  column).disabled))  {
document.getElementById("mode").disabled = true;
drop_status=0;
if(document.getElementById("mode").value !=0) {
    drop_status=play(column);
    drop_status=0;
    do {
    column=select_column();
    drop_status=play(column);
    } while(drop_status!=1);
}
else {
    drop_status=play(column);
};
}; /* if column is filled*/
}

function play(column){
if( document.getElementById("game_over").value==0)  {
drop_status = 0; player=document.getElementById("player").value;
  for(i=0;i<=5;i++) {
     id = 7*i+column;
     if (document.getElementById("circle" + id).value==0)  {
        document.getElementById("circle" + id).value=player;
         if(player==1)  {
           document.getElementById("dot" + id).classList.replace("dot","dot_blue");
            drop_status = 1;
             blue_seq.push(id); document.getElementById("player").value=2;
           for(j=0;j<=6;j++) {            document.getElementById("dropper" + j).classList.replace("dot_blue","dot_red");
            };
         }
         else {
            document.getElementById("dot" + id).classList.replace("dot","dot_red");
             drop_status = 1;
              red_seq.push(id);     document.getElementById("player").value=1;
            for(j=0;j<=6;j++) {            document.getElementById("dropper" + j).classList.replace("dot_red","dot_blue");
             };
         };
         break;
      };
   };
  if(i==5) {
    document.getElementById("but" + column).disabled = true;
   } ;

/*Checking completion of the game*/

   for(i=0;i<=5;i++) {
       for(j=0;j<=6;j++) {

          id = 7*i+j;
          base_circle = document.getElementById("circle" + id).value;
          cnt_verticle=1;
          cnt_horizontal=1;
          cnt_cross=1;
          cnt_cross2=1;
           if (base_circle!=0 && document.getElementById("game_over").value==0) {
           for(k=1;k<=3;k++) {
             if(j<=3) {
              id=7*i+j+k;
              if (base_circle==document.getElementById("circle" + id).value) {
              cnt_horizontal++;
               if (cnt_horizontal==4)  {
                 for(n=0;n<=3;n++){
                   id=7*i+j+k-n; document.getElementById("dot" + id).classList.add("dot_highlight");
                  };
                };
               };
             };
             if(i<=2) {
              id=7*(i+k)+j;
              if (base_circle==document.getElementById("circle" + id).value) {
              cnt_verticle++;
               if (cnt_verticle==4)  {
                 for(n=0;n<=3;n++){
                   id=7*(i+k-n)+j; document.getElementById("dot" + id).classList.add("dot_highlight");
                  };
                };
               };
             };
             if(i<=2 && j<=3)  {
              id=7*(i+k)+j+k;
              if (base_circle==document.getElementById("circle" + id).value) {
              cnt_cross++;
               if (cnt_cross==4)  {
                 for(n=0;n<=3;n++){
                   id=7*(i+k-n)+j+k-n; document.getElementById("dot" + id).classList.add("dot_highlight");
                  };
                };
               };
             };
             if(i<=2 && j>=3)  {
              id=7*(i+k)+j-k;
              if (base_circle==document.getElementById("circle" + id).value) {
              cnt_cross2++;
               if (cnt_cross2==4)  {
                 for(n=0;n<=3;n++){
                   id=7*(i+k-n)+j-k+n; document.getElementById("dot" + id).classList.add("dot_highlight");
                  };
                };
               };
             };
           }; /* for loop k*/
    if(cnt_horizontal==4 || cnt_verticle==4 || cnt_cross==4 || cnt_cross2==4){
       if(player==1) {
           alert("Congrats player Blue!! You won the game.");
       }
       else {
           alert("Congrats player Red!! You won the game.");
       };
document.getElementById("game_over").value=1;
drop_status=1;
     };
          };/* if base circle not filled*/
       };
    };

 if(document.getElementById("game_over").value==0 &&
document.getElementById("but0" ).disabled  && document.getElementById("but1" ).disabled  && document.getElementById("but2" ).disabled  && document.getElementById("but3" ).disabled  && document.getElementById("but4" ).disabled  && document.getElementById("but5" ).disabled  && document.getElementById("but6" ).disabled )  {
           alert("Great job both of you!! The game is a tie");
document.getElementById("game_over").value=1;
drop_status=1;
};
}
else {
drop_status =1;
};/*game over*/
return drop_status;
}
</script>
</html>
